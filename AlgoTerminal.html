<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TERMINAL_SORT_VIZ_V1.0</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #000; border-left: 1px solid #111; }
        ::-webkit-scrollbar-thumb { background: #15803d; border: 1px solid #000; }
        ::-webkit-scrollbar-thumb:hover { background: #22c55e; }
        
        /* Smooth transition for height changes */
        .bar-transition { transition: height 0.1s ease-in-out, background-color 0.15s; }
        
        /* Terminal Glow */
        .term-glow {
            text-shadow: 0 0 5px rgba(74, 222, 128, 0.5), 0 0 10px rgba(74, 222, 128, 0.3);
        }
        .box-glow {
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.2);
        }

        /* CRT Scanline Effect (Optional subtle grid) */
        .crt-grid {
            background-image: linear-gradient(rgba(0, 255, 0, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0, 255, 0, 0.03) 1px, transparent 1px);
            background-size: 20px 20px;
        }
    </style>
</head>
<body class="bg-black text-green-500 font-mono selection:bg-green-500/30 selection:text-black">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;

        // --- Icons ---
        const PlayIcon = ({ size = 20 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>;
        const RotateCcwIcon = ({ size = 20 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12"/><path d="M3 3v9h9"/></svg>;
        const Volume2Icon = ({ size = 20 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>;
        const VolumeXIcon = ({ size = 20 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><line x1="23" y1="9" x2="17" y2="15"></line><line x1="17" y1="9" x2="23" y2="15"></line></svg>;
        const BarChart3Icon = ({ size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>;
        const InfoIcon = ({ size = 18 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>;
        const ZapIcon = ({ size = 18 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>;
        const TerminalIcon = ({ size = 18 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>;

        // --- Constants & Data ---
        const ALGO_INFO = {
            bubble: {
                name: "BUBBLE_SORT",
                desc: "Swaps adjacent elements if order is invalid. Elements 'bubble' to the top.",
                time: "O(n²)",
                space: "O(1)",
                code: `async function bubbleSort(arr) {
  for (let i = 0; i < arr.length; i++) {
    for (let j = 0; j < arr.length - i - 1; j++) {
      if (arr[j] > arr[j + 1]) {
        swap(arr, j, j + 1);
      }
    }
  }
}`
            },
            quick: {
                name: "QUICK_SORT",
                desc: "Partitions array around a 'pivot'. High performance recursive divide & conquer.",
                time: "O(n log n)",
                space: "O(log n)",
                code: `async function quickSort(arr, low, high) {
  if (low < high) {
    let pi = await partition(arr, low, high);
    await quickSort(arr, low, pi - 1);
    await quickSort(arr, pi + 1);
  }
}`
            },
            merge: {
                name: "MERGE_SORT",
                desc: "Divides array, sorts halves recursively, merges results. Stable.",
                time: "O(n log n)",
                space: "O(n)",
                code: `async function mergeSort(arr, l, r) {
  if (l >= r) return;
  let m = l + parseInt((r-l)/2);
  await mergeSort(arr, l, m);
  await mergeSort(arr, m+1, r);
  await merge(arr, l, m, r);
}`
            },
            insertion: {
                name: "INSERTION_SORT",
                desc: "Builds sorted array one item at a time. Good for small data.",
                time: "O(n²)",
                space: "O(1)",
                code: `async function insertionSort(arr) {
  for (let i = 1; i < arr.length; i++) {
    let key = arr[i];
    let j = i - 1;
    while (j >= 0 && arr[j] > key) {
      arr[j + 1] = arr[j];
      j = j - 1;
    }
    arr[j + 1] = key;
  }
}`
            },
            heap: {
                name: "HEAP_SORT",
                desc: "Converts array to Max Heap. Extracts max repeatedly. In-place.",
                time: "O(n log n)",
                space: "O(1)",
                code: `async function heapSort(arr) {
  // Build heap (rearrange array)
  for (let i = n / 2 - 1; i >= 0; i--)
    await heapify(arr, n, i);

  // One by one extract an element from heap
  for (let i = n - 1; i > 0; i--) {
    swap(arr, 0, i);
    await heapify(arr, i, 0);
  }
}`
            }
        };

        // --- Audio Context ---
        let audioCtx = null;
        const playNote = (freq, type = 'sine', duration = 0.1, gainVal = 0.1) => {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = type; // square/sawtooth sound more retro
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gainNode.gain.setValueAtTime(gainVal, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        };

        // --- Helper: Shuffle ---
        const shuffleArray = (array) => {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        };

        // --- Main Component ---
        function SortingVisualizer() {
            // -- State --
            const [array, setArray] = useState([]);
            const [arraySize, setArraySize] = useState(50);
            const [speed, setSpeed] = useState(100); 
            const [isMuted, setIsMuted] = useState(false);
            const [sorting, setSorting] = useState(false);
            const [completed, setCompleted] = useState(false);
            const [currentAlgo, setCurrentAlgo] = useState('bubble');

            // -- Visual State --
            const [activeIndices, setActiveIndices] = useState([]);  
            const [sortedIndices, setSortedIndices] = useState([]);  
            const [specialIndices, setSpecialIndices] = useState([]); 

            // -- Refs --
            const sortingRef = useRef(false);
            const arrayRef = useRef([]);
            const speedRef = useRef(speed);

            const MIN_VAL = 5;
            const MAX_VAL = 100;

            useEffect(() => { speedRef.current = speed; }, [speed]);

            // -- Initialization --
            const resetArray = useCallback(() => {
                sortingRef.current = false;
                setSorting(false);
                setCompleted(false);
                setActiveIndices([]);
                setSortedIndices([]);
                setSpecialIndices([]);

                const linearArray = [];
                for (let i = 0; i < arraySize; i++) {
                    const val = MIN_VAL + (i / (arraySize - 1)) * (MAX_VAL - MIN_VAL);
                    linearArray.push(val);
                }
                const newArr = shuffleArray(linearArray);
                setArray(newArr);
                arrayRef.current = newArr;
            }, [arraySize]);

            useEffect(() => { resetArray(); }, [resetArray]);

            // -- Helper Methods for Algorithms --
            const sleep = async () => {
                const ms = Math.max(0, 200 - speedRef.current * 2);
                return new Promise(resolve => setTimeout(resolve, ms));
            };

            const playSound = (val) => {
                if (isMuted) return;
                const freq = 200 + ((val - MIN_VAL) / (MAX_VAL - MIN_VAL)) * 600;
                playNote(freq, 'square', 0.03, 0.05); // Using 'square' wave for 8-bit sound
            };

            const updateArray = (newArr) => {
                setArray([...newArr]);
                arrayRef.current = [...newArr];
            };

            const isRunning = () => sortingRef.current;

            // --- ALGORITHMS ---
            // (Algorithms logic unchanged, just referencing visual states)
            const runBubbleSort = async () => {
                let arr = [...arrayRef.current];
                let n = arr.length;
                for (let i = 0; i < n - 1; i++) {
                    let swapped = false;
                    for (let j = 0; j < n - i - 1; j++) {
                        if (!isRunning()) return;
                        setActiveIndices([j, j + 1]);
                        playSound(arr[j]);
                        await sleep();

                        if (arr[j] > arr[j + 1]) {
                            [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
                            updateArray(arr);
                            swapped = true;
                            if (!isMuted) playNote(100 + (arr[j]/100)*200, 'sawtooth', 0.05, 0.02);
                        }
                    }
                    setSortedIndices(prev => [...prev, n - i - 1]);
                    if (!swapped) {
                         const remaining = Array.from({length: n-i-1}, (_, k) => k);
                         setSortedIndices(prev => [...prev, ...remaining]);
                         break;
                    }
                }
                finishSorting(n);
            };

            const runInsertionSort = async () => {
                let arr = [...arrayRef.current];
                let n = arr.length;
                setSortedIndices([0]); 
                for (let i = 1; i < n; i++) {
                    if (!isRunning()) return;
                    let key = arr[i];
                    let j = i - 1;
                    setSpecialIndices([i]); 
                    while (j >= 0 && arr[j] > key) {
                        if (!isRunning()) return;
                        setActiveIndices([j, j + 1]);
                        playSound(arr[j]);
                        await sleep();
                        arr[j + 1] = arr[j];
                        updateArray(arr);
                        j = j - 1;
                    }
                    arr[j + 1] = key;
                    updateArray(arr);
                    const sortedRange = Array.from({length: i + 1}, (_, k) => k);
                    setSortedIndices(sortedRange);
                }
                finishSorting(n);
            };

            const runQuickSort = async () => {
                let arr = [...arrayRef.current];
                await quickSortHelper(arr, 0, arr.length - 1);
                finishSorting(arr.length);
            };

            const quickSortHelper = async (arr, low, high) => {
                if (low < high && isRunning()) {
                    let pi = await partition(arr, low, high);
                    setSortedIndices(prev => [...prev, pi]);
                    await quickSortHelper(arr, low, pi - 1);
                    await quickSortHelper(arr, pi + 1, high);
                } else if (low === high && isRunning()) {
                    setSortedIndices(prev => [...prev, low]);
                }
            };

            const partition = async (arr, low, high) => {
                let pivot = arr[high];
                setSpecialIndices([high]);
                let i = (low - 1);
                for (let j = low; j <= high - 1; j++) {
                    if (!isRunning()) return;
                    setActiveIndices([j, i+1]); 
                    playSound(arr[j]);
                    await sleep();
                    if (arr[j] < pivot) {
                        i++;
                        [arr[i], arr[j]] = [arr[j], arr[i]];
                        updateArray(arr);
                        if (!isMuted) playNote(150, 'sawtooth', 0.05, 0.02);
                    }
                }
                [arr[i + 1], arr[high]] = [arr[high], arr[i + 1]];
                updateArray(arr);
                return (i + 1);
            };

            const runMergeSort = async () => {
                let arr = [...arrayRef.current];
                await mergeSortHelper(arr, 0, arr.length - 1);
                finishSorting(arr.length);
            };

            const mergeSortHelper = async (arr, l, r) => {
                if (l >= r || !isRunning()) return;
                const m = l + Math.floor((r - l) / 2);
                await mergeSortHelper(arr, l, m);
                await mergeSortHelper(arr, m + 1, r);
                await merge(arr, l, m, r);
            };

            const merge = async (arr, l, m, r) => {
                if (!isRunning()) return;
                const n1 = m - l + 1;
                const n2 = r - m;
                let L = arr.slice(l, m + 1);
                let R = arr.slice(m + 1, r + 1);
                let i = 0, j = 0, k = l;
                setSpecialIndices(Array.from({length: r-l+1}, (_, idx) => l + idx));

                while (i < n1 && j < n2) {
                    if (!isRunning()) return;
                    setActiveIndices([k]);
                    playSound(arr[k]);
                    await sleep();
                    if (L[i] <= R[j]) {
                        arr[k] = L[i];
                        i++;
                    } else {
                        arr[k] = R[j];
                        j++;
                    }
                    updateArray(arr);
                    k++;
                }
                while (i < n1) {
                    if (!isRunning()) return;
                    setActiveIndices([k]);
                    await sleep();
                    arr[k] = L[i];
                    i++; k++;
                    updateArray(arr);
                }
                while (j < n2) {
                    if (!isRunning()) return;
                    setActiveIndices([k]);
                    await sleep();
                    arr[k] = R[j];
                    j++; k++;
                    updateArray(arr);
                }
            };

            const runHeapSort = async () => {
                let arr = [...arrayRef.current];
                let n = arr.length;
                for (let i = Math.floor(n / 2) - 1; i >= 0; i--) {
                    if (!isRunning()) return;
                    await heapify(arr, n, i);
                }
                for (let i = n - 1; i > 0; i--) {
                    if (!isRunning()) return;
                    setActiveIndices([0, i]);
                    await sleep();
                    [arr[0], arr[i]] = [arr[i], arr[0]];
                    updateArray(arr);
                    setSortedIndices(prev => [...prev, i]);
                    await heapify(arr, i, 0);
                }
                finishSorting(n);
            };

            const heapify = async (arr, n, i) => {
                if (!isRunning()) return;
                setSpecialIndices([i]);
                let largest = i; 
                let l = 2 * i + 1; 
                let r = 2 * i + 2; 

                if (l < n && arr[l] > arr[largest]) largest = l;
                if (r < n && arr[r] > arr[largest]) largest = r;

                if (largest != i) {
                    setActiveIndices([i, largest]);
                    playSound(arr[largest]);
                    await sleep();
                    [arr[i], arr[largest]] = [arr[largest], arr[i]];
                    updateArray(arr);
                    await heapify(arr, n, largest);
                }
            };

            // --- Control Logic ---
            const startSorting = async () => {
                if (sorting) return;
                setSorting(true);
                setCompleted(false);
                sortingRef.current = true;
                setSortedIndices([]);
                setActiveIndices([]);
                setSpecialIndices([]);
                switch (currentAlgo) {
                    case 'bubble': await runBubbleSort(); break;
                    case 'quick': await runQuickSort(); break;
                    case 'merge': await runMergeSort(); break;
                    case 'insertion': await runInsertionSort(); break;
                    case 'heap': await runHeapSort(); break;
                    default: break;
                }
            };

            const finishSorting = (n) => {
                if (!sortingRef.current) return;
                setSortedIndices(Array.from({length: n}, (_, i) => i));
                setActiveIndices([]);
                setSpecialIndices([]);
                if (!isMuted) {
                    playNote(440, 'square', 0.1, 0.1);
                    setTimeout(() => playNote(554, 'square', 0.1, 0.1), 100);
                    setTimeout(() => playNote(880, 'square', 0.2, 0.1), 200);
                }
                setSorting(false);
                setCompleted(true);
                sortingRef.current = false;
            };

            // --- Render ---
            const info = ALGO_INFO[currentAlgo];

            return (
                <div className="min-h-screen crt-grid flex flex-col items-center p-4 sm:p-8">
                
                    {/* 1. Terminal Menu */}
                    <nav className="mb-10 p-1 border border-green-900 bg-black/80 box-glow rounded-none flex flex-wrap justify-center gap-2 z-50">
                        {Object.keys(ALGO_INFO).map(key => (
                            <button
                                key={key}
                                onClick={() => { if(!sorting) { setCurrentAlgo(key); resetArray(); } }}
                                disabled={sorting}
                                className={`px-5 py-2 text-sm font-bold tracking-widest uppercase transition-all duration-100
                                    ${currentAlgo === key 
                                        ? 'bg-green-600 text-black border border-green-500 shadow-[0_0_10px_rgba(34,197,94,0.6)]' 
                                        : 'text-green-700 hover:text-green-400 hover:border-green-500/50 border border-transparent'
                                    }`}
                            >
                                <span className="flex items-center gap-2">
                                    {currentAlgo === key && <span>&gt;</span>}
                                    {ALGO_INFO[key].name}
                                </span>
                            </button>
                        ))}
                    </nav>

                    {/* 2. Header & Info Info */}
                    <div className="w-full max-w-5xl mb-8 grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div className="md:col-span-2 flex flex-col justify-center">
                            <h1 className="text-4xl font-black text-green-500 flex items-center gap-4 mb-3 tracking-tighter term-glow">
                                <TerminalIcon className="text-green-400" size={32} />
                                <span>{info.name}</span> 
                            </h1>
                            <p className="text-green-700 text-base leading-relaxed max-w-2xl font-bold uppercase tracking-wide">
                                <span className="text-green-900 mr-2">//</span> {info.desc}
                            </p>
                        </div>
                        
                        <div className="flex flex-col md:items-end justify-center gap-3">
                            <div className="border border-green-900 bg-black px-4 py-2 flex items-center gap-3 text-sm min-w-[200px] justify-between shadow-lg">
                                <span className="text-green-800 uppercase text-xs">Time_Complexity</span>
                                <span className="font-bold text-green-400 term-glow">{info.time}</span>
                            </div>
                            <div className="border border-green-900 bg-black px-4 py-2 flex items-center gap-3 text-sm min-w-[200px] justify-between shadow-lg">
                                <span className="text-green-800 uppercase text-xs">Space_Complexity</span>
                                <span className="font-bold text-green-400 term-glow">{info.space}</span>
                            </div>
                        </div>
                    </div>

                    {/* 3. Canvas Area */}
                    <div className="w-full max-w-5xl h-[400px] sm:h-[500px] border border-green-800 bg-black relative overflow-hidden flex flex-col shadow-[0_0_20px_rgba(0,255,0,0.05)]">
                        
                        {/* Static Grid Lines */}
                        <div className="absolute inset-0 z-0 opacity-20 pointer-events-none" 
                             style={{ 
                                 backgroundImage: `linear-gradient(#003300 1px, transparent 1px), linear-gradient(90deg, #003300 1px, transparent 1px)`, 
                                 backgroundSize: '20px 20px' 
                             }}>
                        </div>

                        <div className="flex-1 flex items-end justify-center px-6 pb-0 pt-8 gap-[2px] z-10">
                            {array.map((value, idx) => {
                                let colorClass = "bg-green-900/40 border-t border-green-800"; // Default: Dim Green
                                
                                if (completed) {
                                    colorClass = "bg-green-500 shadow-[0_0_15px_rgba(34,197,94,0.6)]"; // Completed: Bright Neon Green
                                } else if (sortedIndices.includes(idx)) {
                                    colorClass = "bg-green-600/80"; // Sorted segment
                                } else if (activeIndices.includes(idx)) {
                                    colorClass = "bg-white shadow-[0_0_20px_rgba(255,255,255,0.8)] z-30"; // Active: Stark White (Cursor-like)
                                } else if (specialIndices.includes(idx)) {
                                    colorClass = "bg-yellow-400 shadow-[0_0_15px_rgba(250,204,21,0.6)] z-20"; // Special: Yellow
                                } else {
                                    colorClass = "bg-green-900/40 hover:bg-green-800/60";
                                }

                                return (
                                    <div
                                        key={idx}
                                        className={`w-full bar-transition ${colorClass}`}
                                        style={{ 
                                            height: `${value}%`,
                                            maxWidth: arraySize < 20 ? '48px' : '100%'
                                        }}
                                    ></div>
                                );
                            })}
                        </div>

                        {/* Controls */}
                        <div className="h-16 border-t border-green-900 bg-black flex items-center justify-between px-6 z-20">
                            
                            <div className="flex items-center gap-4">
                                <button 
                                    onClick={sorting ? resetArray : (completed ? resetArray : startSorting)}
                                    className={`flex items-center gap-2 px-6 py-2 font-bold uppercase tracking-wider transition-all border
                                    ${sorting 
                                        ? 'border-red-900 text-red-500 hover:bg-red-900/20' 
                                        : 'border-green-500 bg-green-900/20 text-green-400 hover:bg-green-500 hover:text-black hover:shadow-[0_0_15px_rgba(34,197,94,0.5)]'
                                    }`}
                                >
                                    {sorting ? <RotateCcwIcon size={18} /> : (completed ? <RotateCcwIcon size={18} /> : <PlayIcon size={18} fill="currentColor" />)}
                                    <span>{sorting ? "ABORT" : (completed ? "REBOOT" : "EXECUTE")}</span>
                                </button>

                                <button 
                                    onClick={() => setIsMuted(!isMuted)}
                                    className="p-2 text-green-800 hover:text-green-400 hover:bg-green-900/20 border border-transparent hover:border-green-800 transition-colors"
                                    title={isMuted ? "UNMUTE" : "MUTE"}
                                >
                                    {isMuted ? <VolumeXIcon size={20} /> : <Volume2Icon size={20} />}
                                </button>
                            </div>

                            <div className="hidden sm:flex items-center gap-8">
                                <div className="flex flex-col gap-1 w-36">
                                    <div className="flex justify-between text-xs text-green-800 font-bold uppercase">
                                        <span>Data_Size</span>
                                        <span className="text-green-400">[{arraySize}]</span>
                                    </div>
                                    <input 
                                        type="range" 
                                        min="10" 
                                        max="150" 
                                        value={arraySize} 
                                        onChange={(e) => {
                                            if (!sorting) setArraySize(Number(e.target.value));
                                        }}
                                        disabled={sorting}
                                        className="h-2 bg-green-900/30 rounded-none appearance-none cursor-pointer accent-green-500 hover:accent-green-400"
                                    />
                                </div>

                                <div className="flex flex-col gap-1 w-36">
                                    <div className="flex justify-between text-xs text-green-800 font-bold uppercase">
                                        <span>Clock_Speed</span>
                                        <span className="text-green-400">{speed >= 100 ? 'MAX' : (speed < 20 ? 'SLOW' : 'NORM')}</span>
                                    </div>
                                    <input 
                                        type="range" 
                                        min="1" 
                                        max="100" 
                                        value={speed} 
                                        onChange={(e) => setSpeed(Number(e.target.value))}
                                        className="h-2 bg-green-900/30 rounded-none appearance-none cursor-pointer accent-green-500 hover:accent-green-400"
                                    />
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* 4. Bottom Info (Code & Legend) */}
                    <div className="w-full max-w-5xl mt-8 grid grid-cols-1 md:grid-cols-2 gap-8">
                        
                        {/* Code Block */}
                        <div className="border border-green-900 bg-black flex flex-col shadow-lg">
                            <div className="h-8 border-b border-green-900 bg-green-900/10 flex items-center px-4 justify-between">
                                <span className="text-xs text-green-500 font-bold tracking-widest uppercase">./src/{currentAlgo}.js</span>
                                <div className="flex gap-1">
                                    <div className="w-2 h-2 bg-green-700"></div>
                                    <div className="w-2 h-2 bg-green-700"></div>
                                    <div className="w-2 h-2 bg-green-700"></div>
                                </div>
                            </div>
                            <div className="p-4 overflow-x-auto text-sm leading-relaxed text-green-600 font-mono">
                                <pre><code>{info.code}</code></pre>
                            </div>
                        </div>

                        <div className="flex flex-col gap-4">
                            {/* Legend */}
                            <div className="border border-green-900 bg-black p-5">
                                <h3 className="text-green-400 font-bold flex items-center gap-2 mb-4 text-sm uppercase tracking-widest border-b border-green-900 pb-2">
                                    <InfoIcon size={16} />
                                    System_Status_Key
                                </h3>
                                <div className="space-y-3">
                                    <div className="flex items-center gap-4">
                                        <div className="w-3 h-3 bg-white shadow-[0_0_8px_rgba(255,255,255,1)]"></div>
                                        <div className="flex flex-col">
                                            <span className="text-xs font-bold text-green-300 uppercase">Processing / Cursor</span>
                                        </div>
                                    </div>
                                    <div className="flex items-center gap-4">
                                        <div className="w-3 h-3 bg-yellow-400 shadow-[0_0_8px_rgba(250,204,21,0.8)]"></div>
                                        <div className="flex flex-col">
                                            <span className="text-xs font-bold text-green-300 uppercase">Pivot / Anchor</span>
                                        </div>
                                    </div>
                                    <div className="flex items-center gap-4">
                                        <div className="w-3 h-3 bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.8)]"></div>
                                        <div className="flex flex-col">
                                            <span className="text-xs font-bold text-green-300 uppercase">Validated / Sorted</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* Tip Card */}
                            <div className="border border-green-800 bg-green-900/10 p-5">
                                <h3 className="text-green-400 font-bold flex items-center gap-2 mb-2 text-sm uppercase tracking-widest">
                                    <ZapIcon size={16} />
                                    System_Log
                                </h3>
                                <p className="text-xs text-green-600 font-mono leading-relaxed">
                                    <span className="text-green-800 mr-2">&gt;&gt;</span>
                                    {currentAlgo === 'quick' && "OPTIMIZATION: Quick Sort partitioning logic detected. Observe the Yellow pivot dividing memory blocks."}
                                    {currentAlgo === 'merge' && "STABILITY CHECK: Merge Sort utilizing recursive stack. 'Divide and Conquer' protocol active."}
                                    {currentAlgo === 'heap' && "MEMORY OPS: Max Heap structure forming. Root element bubbling to stack top."}
                                    {currentAlgo === 'insertion' && "SEQUENTIAL WRITE: Sorted partition growing linearly. efficient for small datasets."}
                                    {currentAlgo === 'bubble' && "LEGACY PROTOCOL: Bubble Sort initiated. High complexity detected. Educational use only."}
                                </p>
                            </div>
                        </div>

                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SortingVisualizer />);
    </script>
</body>
</html>